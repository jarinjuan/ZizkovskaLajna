[gd_scene load_steps=4 format=3 uid="uid://cuifw4nyhafpy"]

[ext_resource type="PackedScene" uid="uid://bmdvgqpvorl5" path="res://Player/bullet.tscn" id="1_c0qr3"]
[ext_resource type="Texture2D" uid="uid://c6kdrgf4wv2x0" path="res://Assets/Sprites/Weapons/spite_pistol_fl.png" id="2_jb0rd"]

[sub_resource type="GDScript" id="GDScript_wl3ew"]
script/source = "extends \"res://Weapons/weapon.gd\"

@export var bullet_scene: PackedScene
@onready var muzzle = $Muzzle

func shoot(target_pos: Vector2) -> void:
	if !can_fire or ammo <= 0:
		return

	var bullet = bullet_scene.instantiate()
	bullet.position = muzzle.global_position
	bullet.rotation = (target_pos - bullet.position).angle()
	get_tree().root.add_child(bullet)

	ammo -= 1
	can_fire = false
	await get_tree().create_timer(fire_rate).timeout
	can_fire = true
"

[node name="Pistol" type="Node2D"]
script = SubResource("GDScript_wl3ew")
bullet_scene = ExtResource("1_c0qr3")

[node name="Sprite2D" type="Sprite2D" parent="."]
scale = Vector2(0.3, 0.3)
texture = ExtResource("2_jb0rd")

[node name="Node2D" type="Node2D" parent="."]
position = Vector2(22, -1)

[node name="Muzzle" type="Marker2D" parent="."]
position = Vector2(6, 0)
